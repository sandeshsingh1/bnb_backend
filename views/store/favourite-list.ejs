<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>My Favorites</title>
  <link rel="stylesheet" href="/nav.css">
  <style>
    body { font-family: Arial, sans-serif; background:#f5f5f5; margin:0; padding:0; }
    nav { display:flex; gap:1rem; }
    nav a {
      text-decoration:none;
      background:white;
      color:#4CAF50;
      padding:0.5rem 1rem;
      border-radius:6px;
      font-weight:bold;
      transition: all 0.2s ease-in-out;
    }
    nav a:hover { background:#45a049; color:white; transform:scale(1.05); }

    .favorites-grid {
      display:grid;
      grid-template-columns:repeat(auto-fill,minmax(250px,1fr));
      gap:1.5rem;
      padding: 2rem;
    }
    .favorite-card {
      background:white;
      border-radius:10px;
      overflow:hidden;
      box-shadow:0 2px 8px rgba(0,0,0,0.1);
      transition:transform 0.2s;
      position: relative;
    }
    .favorite-card:hover { transform:scale(1.03); }
    .favorite-card img { width:100%; height:180px; object-fit:cover; }
    .card-content { padding:1rem; }
    .card-content h3 { margin:0 0 0.5rem; font-size:1.2rem; color:#333; }
    .card-content p { margin:0 0 0.5rem; font-size:0.95rem; color:#666; }
    .price { font-weight:bold; color:#4CAF50; }

    /* Heart style */
    .heart {
      position: absolute;
      top: 10px;
      right: 10px;
      font-size: 24px;
      cursor: pointer;
      color: #ccc;
      transition: color 0.2s;
    }
    .heart.favorited { color: red; }
  </style>
  <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
</head>
<body>

     <%- include('../partials/navbar') %> 

 <header class="page-header">
  <h1>❤️ My Favorite Homes</h1>
</header>


  <main>
    <% if (!favourites || favourites.length === 0) { %>
      <p style="text-align:center; margin-top:2rem;">You don't have any favorite homes yet!</p>
    <% } else { %>
      <div class="favorites-grid">
        <% favourites.forEach(home => { %>
          <div class="favorite-card" data-id="<%= home.id %>">
            <img src="<%= home.photo %>" alt="<%= home.name %>">
            <span class="heart favorited">&#10084;</span> <!-- ✅ red heart -->
            <div class="card-content">
              <h3><%= home.name %></h3>
              <p><%= home.location %></p>
              <p class="price">₹<%= home.price %> / night</p>
            </div>
          </div>
        <% }) %>
      </div>
    <% } %>
  </main>

  <script>
    // Toggle favourite with AJAX
    $(document).ready(function () {
      $('.heart').click(function () {
        const heart = $(this);
        const card = heart.closest('.favorite-card');
        const homeId = card.data('id');
        $.post('/toggle-favourite', { id: homeId }, function (res) {
          if (res.success) {
            card.remove(); // ✅ Remove card from page when unfavorited
          }
        });
      });
    });
  </script>
</body>
</html>
